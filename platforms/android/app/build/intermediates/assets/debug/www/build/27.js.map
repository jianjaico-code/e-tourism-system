{"version":3,"sources":["../../src/pages/add-product/add-product.module.ts","../../src/pages/add-product/add-product.ts"],"names":[],"mappings":"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","file":"27.js","sourcesContent":["import { NgModule } from '@angular/core';\nimport { IonicPageModule } from 'ionic-angular';\nimport { AddProductPage } from './add-product';\n\n@NgModule({\n  declarations: [\n    AddProductPage,\n  ],\n  imports: [\n    IonicPageModule.forChild(AddProductPage),\n  ],\n})\nexport class AddProductPageModule {}\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/add-product/add-product.module.ts","import { Component, ViewChild } from '@angular/core';\nimport { IonicPage, NavController, NavParams, LoadingController, ViewController, ToastController } from 'ionic-angular';\nimport * as firebase from 'firebase';\n\n@IonicPage()\n@Component({\n  selector: 'page-add-product',\n  templateUrl: 'add-product.html',\n})\nexport class AddProductPage {\n\n  @ViewChild('prodPrice') price;\n  @ViewChild('prodName') name;\n  selectedFiles;\n  key;\n  dataArr;\n  data;\n  editStatus: boolean;\n  obj: boolean = false;\n  image;\n  imageUrl;\n\n  constructor(public navCtrl: NavController, public toastCtrl: ToastController, public viewCtrl: ViewController, public loadingCtrl: LoadingController, public navParams: NavParams) {\n    this.key = navParams.data.key;\n    this.initData();\n    this.getData();\n  }\n\n  initData(){\n    this.editStatus = false;\n    this.data = {\n      name: \"\",\n      price: \"\",\n    }\n  }\n\n  detectFiles(event) {\n    this.selectedFiles = event.target.files[0];\n  }\n\n  getData(){\n    let ref = firebase.database().ref('product');\n    ref.on('value', data => {\n      let arr = [];\n      data.forEach(data => {\n        if(data.val().establishmentKey == this.key){\n          arr.push({\n            key: data.key,\n            establishmentKey: data.val().establishmentKey,\n            name: data.val().name,\n            price: data.val().price,\n            imageUrl: data.val().imageUrl\n          });\n          this.obj = true;\n        }\n      });\n      this.dataArr = arr;\n      \n    });\n  }\n\n  edit(key){\n    this.data = key;\n    this.editStatus = true;\n  }\n\n  update(key){\n    let ref = firebase.database().ref('product/' + key);\n    let loading = this.loadingCtrl.create();\n    loading.present();\n\n    if(this.selectedFiles){\n      let file = this.selectedFiles;\n      let storageRef = firebase.storage().ref('/ProductPic/' + file.name);\n      storageRef.put(file).then(snapshot => {\n        return snapshot.ref.getDownloadURL();\n      }).then(downloadURL => {\n          console.log(`Successfully uploaded file and got download link - ${downloadURL}`);\n          this.imageUrl = downloadURL;\n          loading.dismiss().then(() =>{\n            this.viewCtrl.dismiss();\n          });\n          return downloadURL;\n      }).catch(error => {\n          console.log(`Failed to upload file and get link - ${error}`);\n      });\n    }\n    else{\n      this.imageUrl = this.data.imageUrl;\n      loading.dismiss().then(() =>{\n        this.initData();\n      });\n    }\n\n    loading.onDidDismiss(() => {\n      ref.set({\n        establishmentKey: this.key,\n        name: this.name.value,\n        price: this.price.value,\n        imageUrl: this.imageUrl\n      });\n    });\n  }\n\n  savePhotoStorage(){\n    let loading = this.loadingCtrl.create();\n    loading.present();\n    let file = this.selectedFiles;\n    let storageRef = firebase.storage().ref('/ProductPic/' +file.name);\n    storageRef.put(file).then(snapshot => {\n      return snapshot.ref.getDownloadURL();\n    }).then(downloadURL => {\n        console.log(`Successfully uploaded file and got download link - ${downloadURL}`);\n        this.image = downloadURL;\n        loading.dismiss();\n        return downloadURL;\n    }).catch(error => {\n        console.log(`Failed to upload file and get link - ${error}`);\n    });\n\n    loading.onDidDismiss(() =>{\n      let ref = firebase.database().ref('product');\n      ref.push({\n        establishmentKey: this.key,\n        name: this.name.value,\n        price: this.price.value,\n        imageUrl: this.image\n      });\n\n      let toast = this.toastCtrl.create({\n        message: 'Succesfully Added',\n        duration: 3000,\n        position: 'top',\n        cssClass: 'dark-trans',\n      });\n      toast.present();\n\n      this.name.value = \"\";\n      this.price.value = \"\";\n      this.selectedFiles = \"\";\n    });\n  }\n\n  exit(){\n    this.viewCtrl.dismiss();\n  }\n\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/add-product/add-product.ts"],"sourceRoot":""}