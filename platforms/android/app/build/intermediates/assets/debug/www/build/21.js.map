{"version":3,"sources":["../../src/pages/func-news/func-news.module.ts","../../src/pages/func-news/func-news.ts"],"names":[],"mappings":"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","file":"21.js","sourcesContent":["import { NgModule } from '@angular/core';\nimport { IonicPageModule } from 'ionic-angular';\nimport { FuncNewsPage } from './func-news';\n\n@NgModule({\n  declarations: [\n    FuncNewsPage,\n  ],\n  imports: [\n    IonicPageModule.forChild(FuncNewsPage),\n  ],\n})\nexport class FuncNewsPageModule {}\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/func-news/func-news.module.ts","import { Component, ViewChild } from '@angular/core';\nimport { IonicPage, NavController, NavParams, ViewController, AlertController, LoadingController } from 'ionic-angular';\nimport * as firebase from 'firebase';\nimport { AngularFireAuth } from 'angularfire2/auth';\n\n@IonicPage()\n@Component({\n  selector: 'page-func-news',\n  templateUrl: 'func-news.html',\n})\nexport class FuncNewsPage {\n\n  @ViewChild('postDesc') desc;\n  @ViewChild('postTitle') title;\n  selectedFile;\n  myDate: String = new Date().toISOString();\n  name;\n  imageUrl;\n  validData;\n  key;\n  data;\n  status;\n\n  constructor(public navCtrl: NavController, public navParams: NavParams, public loadingCtrl: LoadingController, public alertCtrl: AlertController, public viewCtrl: ViewController, public afAuth: AngularFireAuth) {\n    this.key = navParams.data.key;\n    this.status = navParams.data.status;\n    \n    this.initData();\n    this.checkUser();\n  }\n\n  initData(){\n    if(this.status == true){\n      let ref = firebase.database().ref('postNews');\n      ref.on('value', data => {\n        data.forEach(data => {\n          if(this.key == data.key){\n            this.data = {\n              title: data.val().title,\n              description: data.val().description,\n              name: data.val().name,\n              date: data.val().date,\n              image: data.val().image\n            }\n          }\n        });\n        console.log(this.data);\n      });\n    }\n    else{\n      console.log(\"This is not a data formed\");\n    }\n  }\n\n  closeModal(){\n    this.viewCtrl.dismiss();\n  }\n\n  checkUser(){\n    let ref = firebase.database().ref('user');\n    ref.on('value', data => {\n      data.forEach(data => {\n        if(data.val().email == this.afAuth.auth.currentUser.email){\n          this.name = data.val().name;\n        }\n      });\n    });\n  }\n\n  detectFiles(event) {\n    this.selectedFile = event.target.files[0];\n  }\n\n  checkData(key){\n    if(key){\n      if(this.title.value == \"\"){\n        this.validData = true;\n        let alert = this.alertCtrl.create({\n          title: \"Attention\",\n          subTitle: \"News Title is Empty\",\n          buttons: ['OK']\n        });\n        alert.present();\n      }\n      else if(this.desc.value == \"\"){\n        this.validData = true;\n        let alert = this.alertCtrl.create({\n          title: \"Attention\",\n          subTitle: \"News Description is Empty\",\n          buttons: ['OK']\n        });\n        alert.present();\n      }\n      else{this.validData = false;}\n    }\n    else{\n      if(this.data.title == \"\"){\n        this.validData = true;\n        let alert = this.alertCtrl.create({\n          title: \"Attention\",\n          subTitle: \"News Title is Empty\",\n          buttons: ['OK']\n        });\n        alert.present();\n      }\n      else if(this.data.desc == \"\"){\n        this.validData = true;\n        let alert = this.alertCtrl.create({\n          title: \"Attention\",\n          subTitle: \"News Description is Empty\",\n          buttons: ['OK']\n        });\n        alert.present();\n      }\n      else{this.validData = false;}\n    }\n  }\n\n  savePost(){\n    let ref = firebase.database().ref('postNews');\n    this.checkData(true);\n    if(!this.validData){\n      let loading = this.loadingCtrl.create();\n      loading.present();\n\n      if(this.selectedFile){\n        let file = this.selectedFile;\n        let storageRef = firebase.storage().ref('/News Picture/'  + this.title.value +'/' + file.name);\n        storageRef.put(file).then(snapshot => {\n          return snapshot.ref.getDownloadURL();\n        }).then(downloadURL => {\n            console.log(`Successfully uploaded file and got download link - ${downloadURL}`);\n            this.imageUrl = downloadURL;\n            loading.dismiss().then(() =>{\n              this.viewCtrl.dismiss();\n            });\n            return downloadURL;\n        }).catch(error => {\n            console.log(`Failed to upload file and get link - ${error}`);\n        });\n      }\n      else{\n        this.imageUrl = null;\n        loading.dismiss().then(() =>{\n          this.viewCtrl.dismiss();\n        });\n      }\n\n      loading.onDidDismiss(() => {\n        ref.push({\n          title: this.title.value,\n          name: this.name,\n          description: this.desc.value,\n          image: this.imageUrl,\n          date: this.myDate\n        });\n      });\n    }\n  }\n\n  updatePost(){\n    this.checkData(false);\n    if(!this.validData){\n      let ref = firebase.database().ref('postNews/' + this.key);\n      let loading = this.loadingCtrl.create();\n      loading.present();\n\n      if(this.selectedFile){\n        let file = this.selectedFile;\n        let storageRef = firebase.storage().ref('/News Picture/'  + this.data.title +'/' + file.name);\n        storageRef.put(file).then(snapshot => {\n          return snapshot.ref.getDownloadURL();\n        }).then(downloadURL => {\n            console.log(`Successfully uploaded file and got download link - ${downloadURL}`);\n            this.imageUrl = downloadURL;\n            loading.dismiss().then(() =>{\n              this.viewCtrl.dismiss();\n            });\n            return downloadURL;\n        }).catch(error => {\n            console.log(`Failed to upload file and get link - ${error}`);\n        });\n      }\n      else{\n        this.imageUrl = this.data.image;\n        loading.dismiss().then(() =>{\n          this.viewCtrl.dismiss();\n        });\n      }\n\n      loading.onDidDismiss(() => {\n        ref.set({\n          name: this.data.name,\n          description: this.data.description,\n          image: this.imageUrl,\n          title: this.data.title,\n          date: this.data.date,\n        });\n      });\n    }\n  }\n\n  removePost(){\n    let ref = firebase.database().ref('postNews/' +  this.key);\n    let alert = this.alertCtrl.create({\n      message: 'Are you sure you want to REMOVE this Post?',\n      buttons: [\n        {\n          text: 'Cancel',\n          role: 'cancel',\n          handler: () => {\n            console.log('Cancel clicked');\n          }\n        },\n        {\n          text: 'Yes',\n          handler: () => { \n             ref.remove().then(() => {\n              this.viewCtrl.dismiss();\n             });\n          }\n        }\n      ]\n    });\n    alert.present();\n  }\n\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/func-news/func-news.ts"],"sourceRoot":""}