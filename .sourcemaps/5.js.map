{"version":3,"sources":["../../src/pages/login/login.module.ts","../../src/validators/email.ts","../../src/pages/login/login.ts"],"names":[],"mappings":"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","file":"5.js","sourcesContent":["import { NgModule } from '@angular/core';\nimport { IonicPageModule } from 'ionic-angular';\nimport { LoginPage } from './login';\n\n@NgModule({\n  declarations: [\n    LoginPage,\n  ],\n  imports: [\n    IonicPageModule.forChild(LoginPage),\n  ],\n})\nexport class LoginPageModule {}\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/login/login.module.ts","import { FormControl } from '@angular/forms';\r\n\r\nexport class EmailValidator {\r\n  static isValid(control: FormControl) {\r\n    const re = /^([a-zA-Z0-9_\\-\\.]+)@([a-zA-Z0-9_\\-\\.]+)\\.([a-zA-Z]{2,5})$/.test(\r\n      control.value\r\n    );\r\n\r\n    if (re) {\r\n      return null;\r\n    }\r\n\r\n    return {\r\n      invalidEmail: true,\r\n    };\r\n  }\r\n}\n\n\n// WEBPACK FOOTER //\n// ./src/validators/email.ts","import { Component } from '@angular/core';\nimport { IonicPage, NavController, LoadingController, Loading, AlertController, ModalController, ViewController } from 'ionic-angular';\nimport { FormBuilder, FormGroup, Validators } from '@angular/forms';\nimport { AuthProvider } from '../../providers/auth/auth';\nimport { EmailValidator } from '../../validators/email';\nimport * as firebase from 'firebase';\nimport { AngularFireAuth } from 'angularfire2/auth';\nimport { TabsTouristPage } from '../tabs-tourist/tabs-tourist';\nimport { MenuPage } from '../menu/menu';\n\n@IonicPage()\n@Component({\n  selector: 'page-login',\n  templateUrl: 'login.html'\n})\nexport class LoginPage {\n\n  public loginForm:FormGroup;\n  public loading:Loading;\n\n  constructor(public navCtrl: NavController, private viewCtrl: ViewController, private modalCtrl: ModalController, private afAuth: AngularFireAuth, public authData: AuthProvider, public formBuilder: FormBuilder, public alertCtrl: AlertController, public loadingCtrl: LoadingController) {\n    this.loginForm = formBuilder.group({\n      email: ['', Validators.compose([Validators.required, EmailValidator.isValid])],\n      password: ['', Validators.compose([Validators.minLength(6), Validators.required])]\n    });\n  }\n\n  loginUser(){\n    if (!this.loginForm.valid){\n      var charles = this.alertCtrl.create({\n        title: \"Attention\",\n        subTitle: \"Login Unsuccesfull please try again\",\n      });\n      charles.present();\n    } else {\n      this.authData.loginUser(this.loginForm.value.email, this.loginForm.value.password)\n      .then( authData => {\n        let ref = firebase.database().ref('user');\n        ref.on('value', data =>{\n          data.forEach(data =>{\n            if(data.key == this.afAuth.auth.currentUser.uid){\n              let user = data.val().usertypeid;\n              if(user == 1){\n                if(data.val().status == 1){\n                  console.log(\"Tourist\");\n                  this.navCtrl.setRoot(TabsTouristPage).then(() =>{\n                    this.loading.dismiss();\n                  });\n                }\n                else{\n                  this.errorAlert();\n                }\n              }\n              else if(user == 2){\n                if(data.val().status == 1){\n                  console.log(\"BusinessmanPage\");\n                  this.navCtrl.setRoot(MenuPage,{\n                    userPrivilage: 2,\n                    key: data.key,\n                    name: data.val().name,\n                    pic: data.val().profilePicUrl\n                  }).then(() =>{\n                    this.loading.dismiss();\n                  });\n                }\n                else{\n                  this.errorAlert();\n                }\n              }\n              else if(user == 3){\n                console.log(\"Tourism Officer\");\n                this.navCtrl.setRoot(MenuPage, {\n                  userPrivilage: 3,\n                  key: data.key,\n                  name: data.val().name,\n                  pic: data.val().profilePicUrl\n                }).then(() =>{\n                  this.loading.dismiss();\n                });\n              }\n              else if(user == 4){\n                console.log(\"Super Admin\")\n              }\n            }\n          });\n        });\n      }, error => {\n        this.loading.dismiss().then( () => {\n          let alert = this.alertCtrl.create({\n            message: error.message,\n            buttons: [\n              {\n                text: \"Ok\",\n                role: 'cancel'\n              }\n            ]\n          });\n          alert.present();\n          this.authData.logoutUser();\n        });\n      });\n\n      this.loading = this.loadingCtrl.create({\n        content: \"Logging In, Please Wait...\",\n      });\n      this.loading.present();\n    }\n  }\n\n  errorAlert(){\n    this.loading.dismiss().then(() =>{\n      let alert = this.alertCtrl.create({\n        message: \"Your account has been deactivated due to bad behaviour, please contact the Tourism Officer to re-activate your account: khomarlou11@gmail.com\"\n      });\n      this.authData.logoutUser();\n      alert.present();\n    }); \n  }\n\n  goToResetPassword(){\n    let modal = this.modalCtrl.create('ResetPasswordPage');\n    modal.present();\n  }\n\n  exit(){\n    this.viewCtrl.dismiss();\n  }\n\n  signup(){\n    let modal = this.modalCtrl.create('SignupPage', {key: true});\n    modal.present();\n  }\n\n}\n\n\n// WEBPACK FOOTER //\n// ./src/pages/login/login.ts"],"sourceRoot":""}