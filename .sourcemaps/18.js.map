{"version":3,"sources":["../../src/pages/mapping/mapping.module.ts","../../src/pages/mapping/mapping.ts"],"names":[],"mappings":"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","file":"18.js","sourcesContent":["import { NgModule } from '@angular/core';\nimport { IonicPageModule } from 'ionic-angular';\nimport { MappingPage } from './mapping';\n\n@NgModule({\n  declarations: [\n    MappingPage,\n  ],\n  imports: [\n    IonicPageModule.forChild(MappingPage),\n  ],\n})\nexport class MappingPageModule {}\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/mapping/mapping.module.ts","import { Component, ViewChild, ElementRef } from '@angular/core';\nimport { IonicPage, NavController, NavParams, LoadingController, Platform, ModalController } from 'ionic-angular';\nimport * as firebase from 'firebase';\n\ndeclare var google;\nlet map: any;\nlet infowindow: any;\nlet options = {\n  enableHighAccuracy: true,\n  timeout: 5000,\n  maximumAge: 60000\n};\n\n@IonicPage()\n@Component({\n  selector: 'page-mapping',\n  templateUrl: 'mapping.html',\n})\nexport class MappingPage {\n\n  @ViewChild('from') from;\n  @ViewChild('to') to;\n  @ViewChild('mappingOption') mappingOption;\n  @ViewChild('map') mapElement: ElementRef;\n\n  mobile;\n  data;\n  loadedData\n  myPos;\n  mappingEstTime;\n  mappingDistance;\n  fareShow: boolean;\n\n  markers = [];\n  directionsDisplays = [];\n\n  readData;\n  travelMode;\n  directionsService = new google.maps.DirectionsService();\n  directionsDisplay = new google.maps.DirectionsRenderer({suppressMarkers: true});\n\n  constructor(public navCtrl: NavController, private platform: Platform, public modalCtrl: ModalController, public navParams: NavParams, private loadingCtrl: LoadingController) {\n    if(this.platform.is('mobile')){\n      this.mobile = true;\n      \n      platform.ready().then(() => {\n        this.initMap();\n      });\n    }\n    else{\n      this.mobile = false;\n      \n      platform.ready().then(() => {\n        this.initMap();\n      });\n    }\n\n    this.getEstablishment();\n    this.fareShow = false;\n    this.travelMode = \"DRIVING\";\n   \n  }\n\n  showFare(){\n    let modal = this.modalCtrl.create('FarePage');\n    modal.present();\n  }\n \n  initMap(){\n    const me = this;\n    navigator.geolocation.getCurrentPosition(location => {\n      map = new google.maps.Map(me.mapElement.nativeElement, {\n        zoom: 8.5,\n        center: {lat: 8.8230, lng: 125.0976}\n      });\n\n      me.myPos = new google.maps.LatLng (location.coords.latitude, location.coords.longitude);\n      var icon = {\n        url: \"../../assets/imgs/mylocationpin.png\",\n        scaledSize: new google.maps.Size(50, 60)\n      }\n\n      let myPosMarker = new google.maps.Marker({\n        position: me.myPos,\n        animation: google.maps.Animation.DROP,\n        icon: icon,\n        title: \"Your Position\"\n      });\n\n      myPosMarker.setMap(map);\n\n    }, (error) => {\n      console.log(error);\n    }, options);\n  }\n\n  getEstablishment(){\n    let ref = firebase.database().ref('establishment');\n    ref.on('value', snapshot => {\n      let arr = [];\n      snapshot.forEach(snapshot => {\n        if(snapshot.val().status == 1){\n          arr.push({\n            name: snapshot.val().name,\n            latitude: snapshot.val().latitude,\n            longitude: snapshot.val().longitude\n          });\n          console.log(snapshot.val());\n        }\n      });\n      this.data = arr;\n      this.loadedData = arr;\n    });\n  }\n\n  initializeItem(): void{\n    this.data = this.loadedData;\n  }\n\n  getItems(searchbar){\n    this.initializeItem();\n    let q = searchbar.srcElement.value;\n\n    if(!q){\n      return;\n    }\n\n    this.data = this.data.filter(data => {\n      if(data.name && q){\n        if(data.name.toLowerCase().indexOf(q.toLowerCase()) > -1){\n          return true;\n        }\n        return false;\n      }\n    });\n  }\n\n  initializeMapping(data){\n    for (var i = 0; i < this.markers.length; i++) {\n      this.markers[i].setMap(null);\n    }\n\n    let me = this;\n\n    me.readData = data;\n\n    let Establishment =  new google.maps.LatLng(data.latitude,data.longitude);\n    me.directionsDisplay.setMap(null);\n\n    var icon = {\n      url: \"../../assets/imgs/pin.png\",\n      scaledSize: new google.maps.Size(50, 60)\n    };\n    \n    let marker = new google.maps.Marker({\n      position: Establishment,\n      animation: google.maps.Animation.DROP,\n      icon: icon,\n      title: data.name\n    });\n\n    me.markers = [];\n\n    var request = {\n      origin: me.myPos,\n      destination: Establishment,\n      travelMode: me.mappingOption.value,\n      unitSystem: google.maps.UnitSystem.METRIC\n    };\n\n    me.directionsService.route(request, function(result, status) {\n      if (status === 'OK') {\n\n        me.directionsDisplay.setMap(map);\n\n        me.directionsDisplay.setDirections(result);\n        var point = result.routes[0].legs[0];\n        console.log( 'Estimated travel time: ' + point.duration.text + ' (' + point.distance.text + ')' );\n        me.mappingEstTime = point.duration.text;\n        me.mappingDistance = point.distance.text;\n\n        marker.setMap(map);\n        me.markers.push(marker);\n      }\n    });\n  }\n\n  changeData(event){\n\n    this.mappingOption.value = event;\n\n    if(this.readData){\n      this.initializeMapping(this.readData);\n    }\n  }\n\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/mapping/mapping.ts"],"sourceRoot":""}