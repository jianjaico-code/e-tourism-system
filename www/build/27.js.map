{"version":3,"sources":["../../src/pages/edit-profile/edit-profile.module.ts","../../src/pages/edit-profile/edit-profile.ts"],"names":[],"mappings":"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","file":"27.js","sourcesContent":["import { NgModule } from '@angular/core';\nimport { IonicPageModule } from 'ionic-angular';\nimport { EditProfilePage } from './edit-profile';\n\n@NgModule({\n  declarations: [\n    EditProfilePage,\n  ],\n  imports: [\n    IonicPageModule.forChild(EditProfilePage),\n  ],\n})\nexport class EditProfilePageModule {}\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/edit-profile/edit-profile.module.ts","import { Component, ViewChild } from '@angular/core';\nimport { IonicPage, NavController, NavParams, LoadingController, ViewController } from 'ionic-angular';\nimport * as firebase from 'firebase';\nimport { AngularFireAuth } from 'angularfire2/auth';\n\n@IonicPage()\n@Component({\n  selector: 'page-edit-profile',\n  templateUrl: 'edit-profile.html',\n})\nexport class EditProfilePage {\n\n  @ViewChild('fileInput') fileInput;\n  @ViewChild('address') address;\n  @ViewChild('fullname') name;\n  @ViewChild('password') password;\n  profilePic;\n  userEmail;\n  key;\n  data;\n  private caption: string = \"EDIT\";\n  private isDisabled: boolean = true;\n\n  constructor(public navCtrl: NavController, public viewCtrl: ViewController, public navParams: NavParams, public loadingCtrl: LoadingController, public afAuth: AngularFireAuth) {\n    this.profilePic = this.afAuth.auth.currentUser.photoURL;\n    this.userEmail = this.afAuth.auth.currentUser.email;\n    this.getUserInfo();\n  }\n\n  editProfile(){\n    if(this.caption == \"EDIT\"){\n      this.caption = \"SAVE\";\n      this.isDisabled = false;\n    }\n    else if(this.caption == \"SAVE\"){\n      this.caption = \"EDIT\";\n      this.isDisabled = true;\n      this.saveUserData();\n    }\n  }\n\n  getPicture() {\n    this.fileInput.nativeElement.click();\n  }\n\n  close(){\n    this.viewCtrl.dismiss();\n  }\n\n  saveUserData(){\n  let passRef = this.afAuth.auth.currentUser;\n    if(this.password.value != \"\"){  \n    passRef.updatePassword(this.password.value).then(function() {\n      console.log(\"Update successful\")\n    }).catch(function(error) {\n      console.log(\"Error in - \" + error);\n    });\n    }\n    \n    let ref = firebase.database().ref('user/' + this.key);\n    ref.set({\n      name: this.name.value,\n      email: this.afAuth.auth.currentUser.email,\n      profilePicUrl: this.data.profilePicUrl,\n      address: this.address.value,\n      status: this.data.status,\n      usertypeid: this.data.usertypeid\n    });\n  }\n\n  detectFiles(event) {\n    let profilePic;\n    let loading = this.loadingCtrl.create();\n    loading.present();\n\n    let imageData = event.target.files[0];\n    let refProfile = firebase.storage().ref('/User Picture/' + imageData.name);\n    refProfile.put(imageData).then(snapshot => {\n      return snapshot.ref.getDownloadURL();\n    }).then(downloadURL => {\n        console.log(`Successfully uploaded file and got download link - ${downloadURL}`);\n        profilePic = downloadURL;\n        loading.dismiss();\n        return downloadURL;\n    }).catch(error => {\n        loading.dismiss();\n        console.log(`Failed to upload file and get link - ${error}`);\n    });\n\n    loading.onDidDismiss(() => {\n      let user = firebase.auth().currentUser;\n      \n      user.updateProfile({\n        displayName: this.name.value,\n        photoURL: profilePic\n      }).then(function() {\n        console.log(\"Update Successful\");\n      }).catch(function(error) {\n        console.log(\"Erorr in - \" + error);\n      });\n\n      let ref = firebase.database().ref('user/' + this.key);\n      ref.set({\n        name: this.name.value,\n        email: this.afAuth.auth.currentUser.email,\n        profilePicUrl: profilePic,\n        address: this.address.value,\n        status: this.data.status,\n        usertypeid: this.data.usertypeid\n      });\n    });\n  }\n  \n  getUserInfo(){\n    let ref = firebase.database().ref('user');\n    ref.on('value', data => {\n      data.forEach(data => {\n        if(data.val().email == this.userEmail){\n          this.key = data.key;\n          this.data = data.val();\n        }\n      });\n      console.log(this.data);\n    });\n  }\n\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/edit-profile/edit-profile.ts"],"sourceRoot":""}